<%
content_for :title, current_forum.blank? ? t('threads.threadlist_all') : t('threads.threadlist', name: current_forum.name)
content_for :h1, current_forum.blank? ? t('threads.threadlist_all') : t('threads.threadlist', name: current_forum.name)
%>

<div class="root" data-js="threadlist">
  <% str = '' %>
  <%
  @threads.each do |thread|
    str << '<article class="thread threadlist'
    str << 'sticky' if thread.sticky
    str << thread.attribs['classes'].join(' ') unless thread.attribs['classes'].blank?
    str << ' id="t' + thread.thread_id.to_s + '">'
    str << message_header(thread, thread.message, first: true, show_icons: true)

    if not thread.message.messages.blank? and thread.attribs['open_state'] != 'closed'
      str << message_tree(thread, thread.message.messages, show_icons: true,
                          hide_repeating_subjects: uconf('hide_subjects_unchanged', 'yes') == 'yes')
    end
    str << '</article>'
  end
  %>
  <%== str %>
</div>

<%= render 'pages' %>
