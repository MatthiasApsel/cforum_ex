<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title><%= t "views.title" %></title>

    <meta name="viewport" content="width=device-width,initial-scale=1">

    <%= stylesheet_link_tag "application", :media => "all" %>
    <%= javascript_include_tag "application" %>
    <%= csrf_meta_tags %>

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <script>
    <% if current_user %>current_user = <%== current_user.to_json(:except => [:encrypted_password]) %>;<% end %>
    </script>

    <%= yield(:head) %>

    <% if @own_css_file %><link href="<%= @own_css_file %>" rel="stylesheet" media="all"><% end %>
    <% if @own_js_file %><script src="<%= @own_js_file %>"></script><% end %>

    <% if @own_css %><style>
    <%= @own_css %>
    </style><% end %>

    <% if @own_js %><style>
    <%= @own_js %>
    </style><% end %>

    <script>
      cforum.currentUser = <%= current_user.to_json.html_safe %>;
      cforum.baseUrl = <%= root_url.to_json.html_safe %>;
    </script>
  </head>

  <body data-controller="<%= controller_path %>" data-action="<%= action_name %>"<%= " id='#{yield(:body_id)}'" if content_for? :body_id %>>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">

          <%= render 'layouts/navigation' %>

        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row-fluid">
        <%= render 'layouts/sidebar' %>

        <% if @has_subnav %><div class="span10"><% end %>

        <div id="alerts-container">
        <% flash.each do |name,msg|
          next if not msg.is_a?(String) or name == :timedout # needed because there seem to be messages like „true“ %>
          <div class="alert alert-<%= name == :notice ? "success" : "error" %> fade in">
            <button type="button" class="close" data-dismiss="alert">×</button>
            <%= msg %>
          </div>
        <% end %>
        </div>

        <%= yield %>

        <% if @has_subnav %></div><% end %>
      </div>
    </div>

  </body>
</html>
